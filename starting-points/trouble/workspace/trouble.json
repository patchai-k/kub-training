{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"name":"postgres-pvc"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"1Gi"}}}}
{"apiVersion":"v1","kind":"Secret","metadata":{"name":"loccreds"},"stringData":{"db_password":"trackd","db_user":"postgres"},"type":"Opaque"}
{"apiVersion":"v1","kind":"Service","metadata":{"name":"db"},"spec":{"ports":[{"port":5432}],"selector":{"app":"db"},"type":"ClusterIP"}}
{"apiVersion":"extensions/v1beta1","kind":"Deployment","metadata":{"name":"db"},"spec":{"replicas":1,"selector":{"matchLabels":{"app":"db"}},"template":{"metadata":{"labels":{"app":"db"},"name":"db"},"spec":{"containers":[{"env":[{"name":"POSTGRES_USER","valueFrom":{"secretKeyRef":{"key":"db_user","name":"loccreds"}}},{"name":"POSTGRES_PASSWORD","valueFrom":{"secretKeyRef":{"key":"db_password","name":"loccreds"}}},{"name":"PGDATA","value":"/var/lib/postgresql/data/pgdata"}],"image":"docker.io/postgres:11","name":"postgres","ports":[{"containerPort":5432,"name":"postgresport"}],"volumeMounts":[{"mountPath":"/var/lib/postgresql/data","name":"postgres-data"}]}],"volumes":[{"name":"postgres-data","persistentVolumeClaim":{"claimName":"postgres-pvc"}}]}}}}
{"apiVersion":"v1","kind":"Service","metadata":{"name":"web"},"spec":{"ports":[{"name":"http","port":80,"protocol":"TCP","targetPort":5000}],"selector":{"app":"thelocationapp"},"type":"LoadBalancer"}}
{"apiVersion":"extensions/v1beta1","kind":"Deployment","metadata":{"name":"web"},"spec":{"replicas":1,"selector":{"matchLabels":{"app":"web"}},"template":{"metadata":{"labels":{"app":"web"},"name":"web"},"spec":{"containers":[{"env":[{"name":"POSTGRES_USER","valueFrom":{"secretKeyRef":{"key":"db_user","name":"loccreds"}}},{"name":"POSTGRES_PASSWORD","valueFrom":{"secretKeyRef":{"key":"db_password","name":"loccreds"}}}],"image":"gcr.io/dduck-quack/puddle:1.2","livenessProbe":{"httpGet":{"path":"/earth","port":5000}},"name":"web","ports":[{"containerPort":5000,"name":"webport"}]},{"image":"gcr.io/timf-gcp-404004/dbproxy:5.1","name":"dbproxy"}]}}}}
